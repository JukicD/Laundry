<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:pm="http://primefaces.org/mobile" xmlns:ui="http://java.sun.com/jsf/facelets">



<f:view renderKitId="PRIMEFACES_MOBILE" />


<h:head>

</h:head>

<h:body>
    <pm:page id="first">
        <pm:content>
            <pm:header title="Mitarbeiter auswählen"/>
            <h:form>
                <p:dataGrid id="workers" var="worker" value="#{workerController.workers}" columns="3">
                    <p:commandButton value="#{worker.firstName}" style="font-size: 200%" action="#{mobileController.goTo('pm:second?transition=slide')}">
                        <p:ajax event="click" listener="#{mobileController.setWorker(worker)}" update="second"/>
                    </p:commandButton>
                </p:dataGrid>
            </h:form>
        </pm:content>
    </pm:page>

    <pm:page id="second">

        <pm:header title="Firma auswählen" fixed="true">
            <pm:content>
                <h:form id="inputForm">
                    <p:inputText id="customerSearch" placeholder="Schnellsuche" type="search" value="#{customerAutoCompleteFilter.query}">
                        <p:ajax event="keyup" listener="#{customerAutoCompleteFilter.init}" update="second:outputForm:outputCustomers"/>
                    </p:inputText>
                </h:form>
            </pm:content>

            <p:separator/>
        </pm:header>
        <pm:content>
            <h:form id="outputForm">
                <p:dataGrid id="outputCustomers" var="customer" value="#{customerAutoCompleteFilter.customers}" columns="3">
                    <p:commandButton value="#{customer.name}" style="font-size: 150%" action="#{mobileController.goTo('pm:third?transition=slide')}" update="third fourth:outputItem:outputItems">
                        <p:ajax event="click" listener="#{mobileController.setCustomer(customer)}"/>
                        <p:ajax event="click" listener="#{mobileCategoryController.init}" update="third:categoryForm:categoryTable"/>
                        <p:ajax event="click" listener="#{productAutoCompleteFilter.init}"/>
                    </p:commandButton>
                </p:dataGrid>
            </h:form>
        </pm:content>
        <pm:footer fixed="true">
            <p:separator/>
            <h:form>
                <p:tabMenu>
                    <p:menuitem value="Zurück" icon="ui-icon-back" outcome="pm:first?transition=fade" iconPos="bottom" />
                    <p:menuitem value="Neuer Kunde" icon="ui-icon-plus" outcome="pm:createCustomer?transition=flip" iconPos="bottom"/>
                    <p:menuitem value="Reset" icon="ui-icon-refresh" action="#{customerAutoCompleteFilter.reset}" iconPos="bottom" update="second:outputForm:outputCustomers second:inputForm:customerSearch">
                    </p:menuitem>
                </p:tabMenu>
            </h:form>

        </pm:footer>

    </pm:page>
    <pm:page id="third">
        <pm:content>
            <pm:header title="Art des Artikels" style="font-size: 200%"/>
            <h:form id="categoryForm">
                   <p:dataGrid id="categoryTable" var="category" value="#{mobileCategoryController.categories}" columns="2">
                    <p:commandButton value="#{category.name}" style="font-size: 150%" action="#{mobileController.goTo('pm:fourth?transition=slide')}" update="third fourth:outputItem:outputItems">
                        <p:ajax event="click" listener="#{productAutoCompleteFilter.init}"/>
                        <p:ajax event="click" listener="#{mobileController.setCategory(category)}"/>
                    </p:commandButton>
                </p:dataGrid>
            </h:form>
        </pm:content>

    </pm:page>
    <pm:page id="fourth">
        <pm:content>
            <pm:header title="Artikel auswählen">
                <h:form id="inputItem">
                    <p:inputText id="itemSearch" placeholder="Bezeichnung eingeben" type="search" value="#{productAutoCompleteFilter.query}">
                        <p:ajax event="keyup" listener="#{productAutoCompleteFilter.init}" update="fourth:outputItem:outputItems"/>
                    </p:inputText>
                </h:form>
                <p:separator/>
            </pm:header>

            <h:form id="outputItem">
                <p:dataGrid id="outputItems" var="product" value="#{productAutoCompleteFilter.products}" columns="3">
                    <p:commandButton value="#{product.name}" style="font-size: 200%" action="#{mobileNavigationController.goTo('pm:fifth?transition=slide')}" update="fifth:itemoutputForm:itemoutputTable">
                        <p:ajax event="click" listener="#{mobileController.setProduct(product)}"/>
                        <p:ajax event="click" listener="#{mobileController.update}" update="fifth:itemoutputForm:itemoutputTable"/>
                    </p:commandButton>
                </p:dataGrid>
            </h:form>
        </pm:content>
        <pm:footer fixed="true">
            <h:form>
                <p:tabMenu>
                    <p:menuitem value="Zurück" icon="ui-icon-back" action="#{customerAutoCompleteFilter.reset}" iconPos="bottom" update="second:inputForm:customerSearch second:outputForm:outputCustomers"/>
                    <p:menuitem value="Neue Ware" icon="ui-icon-plus" outcome="pm:createProduct?transition=flip" iconPos="bottom"/>
                    <p:menuitem value="Reset" icon="ui-icon-refresh" action="#{productAutoCompleteFilter.reset}" iconPos="bottom" update="fourth:outputItem:outputItems fourth:inputItem:itemSearch"/>
                </p:tabMenu>
            </h:form>

        </pm:footer>
    </pm:page>

    <pm:page id="fifth">
        <pm:header fixed="true" title="Anzahl">
            <h:form id="iteminputForm">
                <pm:field>
                    <p:inputText id="inputAmount" value="#{mobileController.amount}" placeholder="Stück"/>
                </pm:field>
                <p:commandButton value="Hinzufügen" action="#{mobileController.addItem}" update="fifth:itemoutputForm fifth:iteminputForm" style="width: auto"/>
            </h:form>
        </pm:header>
        <pm:content>
            <h:form id="itemoutputForm">
                <p:dataTable id="itemoutputTable"
                             value="#{mobileController.currentItems}" var="item"
                             emptyMessage="Der Kunde hat noch keine Aufträge!"
                             resizableColumns="true"
                             editable="true"
                             editMode="cell" >

                    <f:facet name="header">
                        <p:outputPanel>
                            <h:outputText value="#{mobileController.customer.name}" />
                        </p:outputPanel>
                    </f:facet>

                    <p:column  headerText="Produkt">
                        <h:outputText value="#{item.name}"/>
                    </p:column>

                    <p:column  headerText="Anzahl">
                        <h:outputText value="#{item.amount}"/>
                    </p:column>

                    <p:column  headerText="Einzelpreis">
                        <h:outputText value="#{item.singlePrice}"/>
                    </p:column>

                    <p:column headerText="Preis">
                        <h:outputText value="#{item.sum}"/>
                    </p:column>
                </p:dataTable>
                <p:commandButton value="Lieferung abschließen" action="#{mobileOrderyController.finishOrder}" update="@form">
                    <p:ajax event="click" listener="#{customerAutoCompleteFilter.reset}" update="second:outputForm:outputCustomers second:inputForm:customerSearch"/>
                </p:commandButton>
            </h:form>
        </pm:content>
    </pm:page>

    <pm:page id="createCustomer">
        <pm:content>
            <h:form>
                <pm:field>
                    <p:outputLabel id="label" for="name" value="Kunde:"/>
                    <p:inputText id="name" value="#{mobileCustomerController.customer.name}" required="true" requiredMessage="Name eingeben!"/>
                </pm:field>
                <p:commandButton value="Erstellen" action="#{mobileCustomerController.createCustomer}" update="second createCustomer"/>
            </h:form>
        </pm:content>
    </pm:page>

    <pm:page id="createProduct">
        <pm:content>
            <h:form>
                <pm:field>
                    <p:outputLabel for="productName" value="Bezeichnung"/>
                    <p:inputText id="productName" value="#{mobileProductController.product.name}"/>
                </pm:field>
                <p:commandButton value="Erstellen" action="#{mobileProductController.createProduct}" update="fourth:outputItem:outputItems createProduct"/>
            </h:form>
        </pm:content>
    </pm:page>

</h:body>

</html>